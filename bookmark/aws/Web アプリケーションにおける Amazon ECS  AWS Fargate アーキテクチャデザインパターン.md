---
title: "Web アプリケーションにおける Amazon ECS / AWS Fargate アーキテクチャデザインパターン"
source: "https://aws.amazon.com/jp/builders-flash/202409/web-app-architecture-design-pattern/"
author:
  - "[[Amazon Web Services]]"
  - "[[Inc.]]"
published:
created: 2025-10-15
description: "Amazon ECS / AWS Fargate を中⼼とした代表的なアーキテクチャパターンを、最新の AWS サービスアップデートを踏まえつつ紹介します。"
tags:
  - "clippings"
image:
---
コミュニティ通信

2024-09-03 | Author: 新井 雅也 (AWS Container HERO)

[無料クーポン特典の詳細 »](https://pages.awscloud.com/dev-magazine-mail-member.html)

## はじめに

こんにちは。AWS Container Hero の新井です。

Amazon ECS の登場から間もなく 10 年が経ちますが、その間、ECS ⾃体の進化に加えて、さまざまな AWS マネージドサービスとの連携が可能になりました。 現在では、コンテナベースのワークロードを活⽤することで実現できないことを探す⽅が難しいほど、柔軟なアーキテクチャが構築できるようになっています。 しかし、⾃由度が⾼い分、要件に合ったアーキテクチャを模索する際には、迷うことも多いでしょう。

AWS上でシステムを適切に構築するためには、あらかじめサービス間のつなぎ⽅やパターン、その特徴を把握しておくことが重要です。 これにより、フィージビリティを迅速に確認でき、その後のトライアンドエラーのサイクルを加速させることができます。

今回は、最新の AWS サービスアップデートを踏まえつつ、Amazon ECS / AWS Fargate を中⼼とした代表的なアーキテクチャパターンを紹介します。

  
[**X ポスト »**](https://twitter.com/intent/tweet?text=Web%20%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%20Amazon%20ECS%20/%20AWS%20Fargate%20%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%0Ahttps%3A//aws.amazon.com/jp/builders-flash/202409/web-app-architecture-design-pattern/%20%23AWS%E3%82%A6%E3%82%A7%E3%83%96%E3%83%9E%E3%82%AC%E3%82%B8%E3%83%B3) **|** [**Facebook シェア »**](https://www.facebook.com/sharer/sharer.php?u=https%3A//aws.amazon.com/jp/builders-flash/202409/web-app-architecture-design-pattern/) **|** [**はてブ »**](http://b.hatena.ne.jp/add?&url=https%3A//aws.amazon.com/jp/builders-flash/202409/web-app-architecture-design-pattern/)

![Architecture diagram showing a web application design pattern on AWS, featuring an internet gateway, public and private subnets within a VPC, an Application Load Balancer (ALB), Amazon ECS for running API tasks in a private subnet, and Amazon Aurora as the database in another private subnet.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/mavvtuzr-img-web-app-architecture-design-pattern-01.b52d517ef80b79c78ac911cc542d6e92717da9db.png) ![Diagram illustrating a secure web application architecture design pattern on AWS. The architecture includes a VPC with a public subnet hosting an Application Load Balancer (ALB) and private subnets for Amazon ECS (running ECS Task API) and Amazon Aurora. An AWS WAF (Web Application Firewall) enforces security rules based on OWASP Top 10 and restricts access by country. Diagram labels are partly in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/6drih0fp-img-web-app-architecture-design-pattern-02.e8415d4780239c6e48c61ca3eb4f0bcf48e1e6f1.png)

## 1-3. API Gateway による API サービスパターン (WAF なし)

ビジネスやサービスの要件に応じて、認証処理のカスタマイズやアクセスの流量制御を実装したい場合には、Amazon API Gateway を利用することが効果的です。API Gateway には [REST API と HTTP API の 2 種類](https://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/http-api-vs-rest.html) があり、それぞれで利用できる機能が異なります。

今回は HTTP API の例を紹介しますが、このパターンでは [バックエンドリソースとして ALB とのプライベート統合が可能](https://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/http-api-vpc-links.html) です。

また、AWS Cloud Map とプライベート統合することで、ECS タスクに直接処理を連携させることもできます。

## 構成図

![Architecture diagram showing a web application design pattern on AWS Cloud, featuring Amazon API Gateway (HTTP API) connecting via VPC Link to an Application Load Balancer (ALB), Amazon ECS tasks (API), and Amazon Aurora within private subnets. Diagram labels are in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/ydmd1vba-img-web-app-architecture-design-pattern-03.df1a616acaf7f1eb8c91603f01dcb6760fd0cb54.png)

## 1-4. API Gateway による API サービスパターン (WAF あり)

先ほど紹介した HTTP API を使用する API Gateway パターンでは、仕様上 WAF との連携ができません。セキュリティ対策として WAF を利用したい場合には、REST API による API Gateway を選択する必要があります。一方、REST API を使用する API Gateway では、ALB や Cloud Map とのプライベート統合はサポートされていません。そのため、WAF の利用を前提として、REST API による API Gateway を利用しつつ、API Gateway と ECS タスク間をプライベートな経路に保つためには、NLB を経由させる必要があります。

![Architecture diagram illustrating a web application design pattern using AWS services such as Amazon API Gateway, AWS WAF, Network Load Balancer (NLB), Amazon ECS, and Amazon Aurora in a VPC with private subnets.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/jh6fgafi-img-web-app-architecture-design-pattern-04.4fcb77278dd2f6245366243bfe3aee7e58db191f.png) 代替策として、ALB をパブリックエンドポイントとして設定し、HTTP API を使用する API Gateway リソースと接続することが可能です。また、HTTP API の前に CloudFront を配置し、CloudFront に AWS WAF を設定することで、HTTP API を使用しつつも WAF による保護を実現することができます。

![Architecture diagram showing a web application design pattern on AWS Cloud. The diagram illustrates components such as Amazon CloudFront, AWS WAF, Amazon S3 for SPA deployment, Amazon API Gateway (REST API), Amazon ECS, and Amazon Aurora, with detailed connection flows and security notes in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/6j1jhmao-img-web-app-architecture-design-pattern-05.d8f95e24e6756ed130c26503eeaaff2a709c5dab.png) 先ほど取り上げた「API Gateway による API サービスパターン」と組み合わせることで、Web アプリケーションに必要な API を提供する構成となっていますね。API Gateway による API サービスパターンとの違いは、API リクエストが CloudFront を通過する点です。もちろん、CloudFront を経由せずに API を実装することも可能ですが、エンドポイントを分離すると CORS の対応が必要になるため、CloudFront でエンドポイントを集約することで実装をシンプルにすることができます。CloudFront と WAF を連携させているにもかかわらず、CloudFront を経由せずに API Gateway に直接アクセスされることは避けたいところです。これを防ぐために、CloudFront のオリジンカスタムヘッダーと API Gateway の API キー認証を有効化する構成が有効です。ただし、API Gateway の API キー認証は REST API のみが対応しており、HTTP API では対応していません。その場合、カスタム認証などで制御する必要があります。

![Architecture diagram of a web application design pattern on AWS Cloud featuring Amazon ECS for rendering and backend API tasks, AWS WAF, ALB, VPC with public and private subnets, and Amazon Aurora as the database.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/j1ggkb27-img-web-app-architecture-design-pattern-06.2ebe654dba64032d0ffbf88591d804d7fea9b5be.png) このアーキテクチャ例では、エンドポイントを提供するために ALB を使用していますが、API Gateway を利用したサービス提供ももちろん構成可能です。また、グローバルからのアクセスを最適化したいケースでは、エッジロケーションの有効活用の観点から ALB の手前に CloudFront を配置することも有効でしょう。

![Architecture diagram showing a web application design pattern using AWS services including Amazon Cognito, AWS WAF, an Application Load Balancer (ALB), Amazon ECS, and Amazon Aurora within a VPC with public and private subnets. The workflow illustrates client access via the internet, authentication, routing, and data management layers.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/76u8hkw9-img-web-app-architecture-design-pattern-07.566fda8437bfb7df52035340cdb000126779cdc6.png) ![A diagram showing a web application architecture design pattern using AWS ECS Services, ECS Tasks, and internal Application Load Balancer (ALB), with a note about using Route 53 private hosted zone ALIAS records for managing ALB domains. The diagram annotations are in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/us2nqeer-img-web-app-architecture-design-pattern-08.ed3da6e2331056cc9a99f10634417f4abb9d92b2.png) ![Diagram showing a web application architecture design pattern for service discovery using Amazon ECS, AWS Cloud Map, and Amazon Route 53, with annotations in Japanese. The flow illustrates ECS services registering with AWS Cloud Map, updating Route 53 records, and resolving names for ECS tasks.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/compute/approved/images/xiobm5kw-img-web-app-architecture-design-pattern-09.0f1ea7ce7d82454526b225a07ba2e9d0fe097a62.png) ![Architecture diagram showing the integration of Amazon ECS Service, Envoy, AWS App Mesh, AWS Cloud Map, and Amazon Route 53 for web application service discovery and management. Includes Japanese labels and steps indicating configuration, service registration, and service discovery.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/compute/approved/images/bk0lqhgh-img-web-app-architecture-design-pattern-10.0b6cf2c09be1e631f1e82f2275934e5ce953a087.png)

![Architecture diagram showing integration between two ECS services using Envoy sidecars and ECS Service Connect, with AWS Cloud Map for service discovery.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/compute/approved/images/1h504vy6-img-web-app-architecture-design-pattern-11.3aa1a5303dcd0c432f275f7dd9f7bd3b895a11ad.png) なお、今回は詳しく触れませんが、VPC Lattice を利用することで、複数のマイクロサービスリソースを抽象化しつつ接続するパターンも存在します。VPC やアカウントを跨る場合のサービス間接続において有効です。

![Architecture diagram showing an AWS Cloud design where Amazon EventBridge is used to trigger Amazon ECS tasks on a schedule (daily at 12:00), within a private subnet inside a VPC. Diagram labels and annotations are in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/w1dqc9va-img-web-app-architecture-design-pattern-12.0c25cd1d2fadd341c9b430fb3f2981e7afab1c62.png) ![Architecture diagram showing an event-driven workflow on AWS using Amazon EventBridge to trigger AWS Step Functions, which orchestrate multiple ECS Tasks (Jobs). Diagram includes Japanese annotation for retry implementation. Useful for explaining event-driven job orchestration patterns in web application architecture.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/uaj1nvyg-img-web-app-architecture-design-pattern-13.1427649fa1a35f0bd9b29febac5bc7c8f8195136.png)

![Architecture diagram showing integration of Amazon EventBridge, AWS Step Functions workflow, AWS Lambda functions, and Amazon ECS services (API), illustrating a pattern for web applications. The diagram includes Japanese annotations regarding calling existing APIs provided as microservices.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/p2cbw545-img-web-app-architecture-design-pattern-14.69235ee93069dc23736140a363100bbcedf6adb0.png) なお、今回は一般的な Web アプリケーションサービスを想定しているため紹介は割愛しますが、金融系サービスやヘルスケア等で求められるハイワークロードなジョブ実行が必要ケースでは、AWS Batch および Amazon EC2 や ECS を組み合わせたパターンも有効でしょう。

![Diagram showing a web application architecture pattern where logs from an Amazon ECS Task container are sent to Amazon CloudWatch Logs for monitoring and analysis.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/compute/approved/images/sv2abuoo-img-web-app-architecture-design-pattern-15.3162c66a89910f113a70dfec864492e260092dad.png) ![Architecture diagram showing an Amazon ECS Task with a sidecar container using Fluent Bit (Firelens) to route logs from the main container to Amazon S3 and Amazon CloudWatch Logs.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/containers/approved/images/o6q7sc1a-img-web-app-architecture-design-pattern-16.40fba79f9f1bec2750bdb2fb260e9c596d636178.png)

![Architecture diagram illustrating an AWS solution for error log notification from an ECS task to Slack via Amazon CloudWatch Logs, Amazon SNS, and AWS Chatbot. The diagram shows containers with a Fluent Bit sidecar (Firelens), filtering error logs with subscription filters, and sending notifications to Slack. Japanese language labels are used throughout the diagram.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/rcu40qdp-img-web-app-architecture-design-pattern-17.418e8231e99df8dc2e658ca0d884e9e58652f387.png) 別のパターンとして、CloudWatch メトリクスフィルターから CloudWatch アラームを作成し、それを SNS→Chatbot→Slack へと接続する方法もあります。ただし、この場合、アプリケーションのエラーログ内容を Slack に直接通知することはできません。そのため、ログ内容も含めて通知したい場合には、最初に述べたアーキテクチャパターンをお勧めします。

![Architecture diagram showing Amazon ECS Task with Firelens sidecar container using Fluent Bit, Amazon EventBridge, SNS, AWS Chatbot, and Slack integration. The flow demonstrates filtering ECS-related events and delivering notifications to Slack. Diagram labels are in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/compute/approved/images/z1bwiqv5-img-web-app-architecture-design-pattern-18.aa4e3cc0a973036383119b52548945763175b4ab.png) ![Diagram showing a continuous integration and continuous deployment (CI/CD) architecture pattern for a web application using GitHub Actions, Amazon ECR, and Amazon ECS. The diagram includes Japanese labels and illustrates the developer workflow from code push, pull request review, CI testing, image build and deploy, to ECS task update in AWS Cloud.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/66gbgj76-img-web-app-architecture-design-pattern-19.d01a2e6a471a080d5278af82a6c1fab9b621a17d.png) ![Diagram illustrating a web application architecture design pattern for CI/CD using GitHub, GitHub Actions, AWS CodePipeline, CodeBuild, CodeDeploy, Amazon ECR, and Amazon ECS. Japanese labels show the development workflow from code push, pull request, code review, CI/CD pipeline, container build, and deployment to ECS.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/product-categories/developer-tools/approved/images/jo1cs203-img-web-app-architecture-design-pattern-20.8f09561966d0a98d1d8fbe25488ac6f451c4cb38.png) ![Architecture diagram showing the integration of AWS Systems Manager Session Manager, Amazon ECS, and Amazon Aurora within a VPC using private subnets for a web application. The diagram includes Japanese annotations describing debugging and database operations via shell, as well as ECS task settings for command execution.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/aa0ycn95-img-web-app-architecture-design-pattern-21.80dad87afa3f6d9cde5ccb5be42bfcba9016f837.png)

[Amazon VPC AWS CloudShell での の使用](https://docs.aws.amazon.com/ja_jp/cloudshell/latest/userguide/using-cshell-in-vpc.html)

![Architecture diagram showing a web application design pattern on AWS, including access via AWS CloudShell, Amazon ECS tasks running in private subnets, and integration with Amazon Aurora. Diagram and text are in Japanese.](https://d1.awsstatic.com/onedam/marketing-channels/website/aws/ja_JP/architecture/approved/images/2tt0wjzb-img-web-app-architecture-design-pattern-22.18e47ec641e797cf91be3a34d2a1d9b6ef7bc1cb.png) ECS Exec 利用パターンと異なり、ECS 側の設定変更が不要です。しかし、CloudShell は永続ストレージをサポートしていないため、セッション終了後にホームディレクトリが削除されます。継続的にデバッグを行う場合は、この点に注意が必要です。また、CloudShell は リージョン毎に実行環境の利用時間に関する上限 があります。アカウント全体で月 200 時間までの制限があり、上限緩和申請により月 1000 時間まで増やすことができます。利用においては、この制約内で運用できるか判断しましょう。 [リージョン毎に実行環境の利用時間に関する上限](https://docs.aws.amazon.com/cloudshell/latest/userguide/limits.html#shell-limits-per-month)